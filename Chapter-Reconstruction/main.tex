\chapter{Charged pion reconstruction and identification}
\label{ch:reconstruction}
\graphicspath{{Chapter-Reconstruction/figures/}}

Charged particles produced in collisions at the ATLAS \ac{IP} travel helical paths through the \id due to the solenoid magnetic field.
The three subdetectors register hits at various space-point locations as each of these particles passes through them, often 11 silicon and 15--30 \trt hits for a typical particle of sufficiently high \pt.
The trajectories of these particles must be reconstructed from the collection of all the space-point hits in order to infer the initial momentum of all of the collision products.
This procedure is non-trivial and computationally intensive, particularly because the trajectories of charged particles are altered when they pass through detector elements, via ionization energy loss and multiple scattering.

\section{Tracking algorithm}

%% for general track fitting overview see:
%% http://www.phys.ufl.edu/~avery/fitting.html
%% atlas overview see https://cds.cern.ch/record/1435196/files/ATLAS-CONF-2012-042.pdf
%% from \cite{ATLAS:2012jma}

%% discuss seeding before kalman filter?
%% i.e. split into ``pattern finding'' and ``track fitting'', though with NEWT there is ``no clear border'' between these modules
%% discuss inside-out and outside-in separately?

While the classification is not absolute, the ATLAS track reconstruction procedure can be divided roughly into two parts: first track seeds are identified, then tracks are extended and evaluated with a global fit \cite{Cornelissen:2007vba}. %% ATLAS new tracking (NEWT)
Each of these procedures will be described separately in the following sections.
Overall, the reconstruction of collision vertices and the charged-particle products has very good performance, even in the high-luminosity environment of the \lhc with tens of simultaneous collisions along the beamline \cite{ATLAS:2012jma}. %% performance of tracking and vertexing (2012), w/ description of reconstruction

\subsection{Seeding track candidates}

The baseline track finding algorithm uses inside-out reconstruction.

An additional round of seeding is performed using an outside-in algorithm called back-tracking.
This process is designed to reconstruct secondary particles, which are generated in the decays of primary particles and so do not necessarily originate from near the beam line.
The \trt drift tube hits do not provide fine-scale information along the straw direction, so seeds are built in the $r - \phi$ plane in the \trt barrel and the $r - z$ plane in the \trt end-cap.
Back-tracking is not well-suited for low-\pt particles, which spiral out of the \id without making it to the \trt, so the targeted particles have reasonably straight-line trajectories.
The Hough transform \cite{Duda:1972:UHT:361237.361242} is used to detect straight-line sets of three \trt hits which are used as track candidate seeds.
The extension of these \trt segments are evaluated in multiple $\eta$ slices to accommodate the fact that the seed-finding is done in the transverse plane.

\subsection{Track fitting}

\begin{figure}[t]
  \includegraphics{track_schematic.png}
  \caption{The track parameters defining a helical trajectory.}
  \label{fig:trk_params}
\end{figure}

%% Kalman filter -- dedicated subsection?
A helical track path is defined by the 5-tuple
\( \left( d_0, z_0, \theta, \phi, q/p \right) \)
where $d_0$ and $z_0$ are the transverse and longitudinal distance from the beamspot at the point of closest approach, $\theta$ and $\phi$ are the polar and azimuthal angles of the track at this point, and $q/p$ is the inverse magnitude of the track's total momentum signed by the charge of the particle\footnote{This ratio is related to the transverse radius of curvature $R$ and the axial magnetic field $B$ by $q/p = \sin \theta / B R$.} (\Cref{fig:trk_params}).
However, every interaction with a detector element modifies a charged particle's trajectory through ionization energy loss and multiple scattering.
Since there are tens of hits in most tracks, a typical track has $\mathcal{O}(100)$ parameters in its description, and the parameters before and after a hit are not independent.
It is computationally infeasible to process a single global fit for each track candidate with this many correlated parameters.

\cite{Cornelissen:2008zza} %% global chi^2 track fitter

%% \cite{Aad:2010bx} %% ID commissioning and calibration - good summary (already referenced -- not as much detail on the track alg)

\section{Track reconstruction performance}

\begin{figure}[t]
  \includegraphics[width=0.49\linewidth]{atl_com_phys_2012_1541_fig_07_eff_pt.png}
  \includegraphics[width=0.49\linewidth]{atl_com_phys_2012_1541_fig_08_eff_eta.png}
  \caption{The Run-1 track reconstruction efficiency as a function of transverse momentum (left) and pseudorapidity (right).}
  \label{fig:trk_eff}
\end{figure}

\section{Track selection} %% ? does this need its own section? possibly in analysis section

\section{Pion identification}


